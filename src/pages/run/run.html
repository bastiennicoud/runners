<ion-header>

  <ion-navbar>
    <ion-title *ngIf="run">{{run.title}}</ion-title>
  </ion-navbar>

  <ion-segment [(ngModel)]="view">
    <ion-segment-button value="information">
      Informations
    </ion-segment-button>
    <ion-segment-button value="waypoints">
      Trajet
    </ion-segment-button>
    <ion-segment-button value="runners">
      Inscriptions
    </ion-segment-button>
  </ion-segment>

</ion-header>



<ion-content padding>

  <ion-refresher (ionRefresh)="refreshRun($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div *ngIf="run" [ngSwitch]="view">

    <!-- Information -->
    <div *ngSwitchCase="'information'">

      <ion-list no-lines>

        <ion-item>
          <ion-icon name="calendar" item-left></ion-icon>
          <h2>devrait commencer le :</h2>
          <p><em>{{run.beginAt | date:'fullDate'}} à {{run.beginAt | date:'shortTime'}}</em></p>
        </ion-item>

        <ion-item>
          <ion-icon name="car" item-left></ion-icon>
          <span *ngIf="run.startAt">
            <h2>Le run a démarré le :</h2>
            <p><em>{{run.startAt | date:'fullDate'}} à {{run.startAt | date:'shortTime'}}</em></p>
          </span>
          <span *ngIf="!run.startAt">
            <p><em>Le run n'a pas encore démarré</em></p>
          </span>
        </ion-item>

        <ion-item *ngIf="run.startAt && !run.endAt">
          <p><em>Le run est toujours en cours</em></p>
        </ion-item>

        <ion-item *ngIf="run.startAt && run.endAt">
          <ion-icon name="checkmark" item-left></ion-icon>
          <h2>Le run c'est terminé le :</h2>
          <p><em>{{run.endAt | date:'fullDate'}} à {{run.endAt | date:'shortTime'}}</em></p>
        </ion-item>

      </ion-list>

    </div>

    <!-- Waypoints -->
    <div *ngSwitchCase="'waypoints'">

      <ion-list class="waypoints" no-lines>

        <ion-item *ngFor="let waypoint of run.waypoints">
          <ion-icon name="compass" item-left></ion-icon>
          <h2>{{waypoint.nickname}}</h2>
          <p><em>{{waypoint.geocoder.formatted_address}}</em></p>
        </ion-item>

      </ion-list>

    </div>

    <!-- Runners -->
    <div *ngSwitchCase="'runners'">

      <ion-list no-lines>

        <button ion-item *ngFor="let runner of run.runners" (click)="showRunner(runner)">
          <ion-icon name="car" item-left></ion-icon>
          <h2 *ngIf="runner.vehicle">{{runner.vehicle.name}}</h2>
          <h2 *ngIf="!runner.vehicle">{{runner.vehicleCategory.type}} ??</h2>
          <p *ngIf="runner.user">{{runner.user.fullname}}</p>
          <p *ngIf="!runner.user">-</p>
        </button>

      </ion-list>

    </div>

  </div>

</ion-content>

<ion-footer>
  <ion-toolbar *ngIf="run && authStorage.user.belongsToRun(run)">
    <ion-title *ngIf="run.status == 'created'">
      <i>en attente</i>
    </ion-title>
    <ion-title *ngIf="run.status == 'ready'">
      <i>Le groupe est prêt</i>
      <button ion-button item-right>Commencer</button>
    </ion-title>
    <ion-title *ngIf="run.status == 'inProgress'">
      <i>en cours</i>
      <button ion-button item-right>Terminer</button>
    </ion-title>
    <ion-title *ngIf="run.status == 'completed'">
      <i>run terminé</i>
    </ion-title>
  </ion-toolbar>
</ion-footer>
